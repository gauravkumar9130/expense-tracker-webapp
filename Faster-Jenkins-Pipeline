pipeline {
    agent any
    environment {
        SONAR_HOME = tool "Sonar"
    }
    stages {
        stage("Clone Code from GitHub") {
            steps {
                git url: "https://github.com/gauravkumar9130/expense-tracker-webapp", branch: "master"
            }
        }

        stage("Build") {
            steps {
                sh 'mvn clean compile'
            }
        }

        stage("SonarQube Quality Analysis") {
            steps {
                withSonarQubeEnv("Sonar") {
                    sh "$SONAR_HOME/bin/sonar-scanner -Dsonar.projectName=mydevproject -Dsonar.projectKey=mydevproject -Dsonar.sources=. -Dsonar.java.binaries=target/classes"
                }
            }
        }


        stage("Deploy") {
            steps {
                echo "Hello I am Deploying"
            }
        }
    }
}
